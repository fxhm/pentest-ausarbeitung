

LANMAN: LAN Manager

  verwendet "LM Hash" als Hashfunktion

  LM Hash
    -Wurde vor WinNT zum Speichern von Passwörtern benutzt
    -Sehr schlechte Hashfunktion
    -Kann innerhalb weniger Stunden gebruteforced werden
    -Ist als Legacy unter Windows weiter verfügbar, jedoch seit WinVista in der Standardeinstellung deaktiviert



NTLM: NT (New Technology) LAN Manager, der Nachfolger von LAN Manager (LANMAN)

  -Suite von Sicherheitsprotokollen
  -Paket bestehend aus:
    LAN Manager
    NTLMv1
    NTLMv2
    NTLMv3
  -NTLM-Passwörter können mit moderner Hardware innerhalb weniger Stunden (Stand 2019: 2,5 Stunden) gecrackt werden

Server Message Block (SMB): Netzprotokoll für Datei-, Druck- und andere Serverdienste in Rechnernetzen
  -Früher als "Common Internet File System" (CIFS) bekannt
  -Kern des "LAN Manager"-Netzwerkbetriebssystems
  -Wird z.B. auch von Samba (freies Programmpaket um Windows-Funktionen auf anderen OS zu verwenden) verwendet
  -Die für kritische Sicherheitslücken anfällige Version 1.0 ist auch noch in aktuellen Win-Versionen enthalten und wird aufgrund ihrer 30 Jahre alten Architektur als Risikofaktor eingestuft.
  -WannaCry aus dem Jahr 2017 verwendete das Protokoll als Einfallstor


Pass-The-Hash
  -Angriff, bei dem nur der Username und LM- oder NTLM-Hashwert des Passworts und nicht das Passwort im Klartext benötigt wird.
  -Kann gegen jeden Server oder Dienst angewendet werden, der NT- oder NTLM-Authentifizierung akzeptiert
  -Man benötigt zunächst jedoch den Passwort-Hashwert

  Akquirierung des Passwort-Hashes
    -Wenn man Adminrechte hat, kann man die gecachten Credentials von Nutzern auslesen, die zuvor an der Maschine eingeloggt waren.
    -Dumpen der SAM-Datenbank (Security Account Manager). Damit kommt man jedoch nur an die lokalen Accounts des jeweiligen Rechners
    -Abhören des LM- oder NTLM-Dialogs zwischen einem Client und Server. Der Hash ist dann jedoch verschlüsselt, die Verschlüsselung muss gecrackt werden (bruteforce)
    -Dumpen der User Credentials, die von Windows im Speicher des lsass.exe (Local Security Authority Subsystem Service) abgelegt werden. Hier können auch Domain User oder Admins dabei sein, die sich z.B. über Remote Desktop Protocol (RDP) (von Microsoft) verbunden haben
